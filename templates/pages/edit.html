
{% if error %}
<div class="alert alert-danger">
  <i class="fa fa-exlamation-triangle"></i>
  {{ error }}
</div>
{% endif %}

{% if post.error %}
<div class="alert alert-danger">
  <div class="d-flex">
    <div class="d-flex mr-auto">
      Reddit had a problem with this post:
      {{ post.error }}
    </div>
    {#
    <div class="d-flex justify-content-end">
      <a class="btn btn-danger" href="#">
        <i class="fa fa-redo"></i>
        Retry
      </a>
    </div>
    #}
  </div>
</div>
{% endif %}

<form method="post">
  {% if post.url is empty %}
  <div class="form-group">
    <label for="subreddit">Sub Reddit</label>
    <input type="text" name="subreddit" class="form-control" id="subreddit" placeholder="/r/kde" value="{{ post.subreddit }}">
  </div>
  <div class="form-group">
    <label for="title">Title</label>
    <input type="text" name="title" class="form-control" id="title" placeholder="Something Really Cool!" value="{{ post.title }}">
  </div>
  <div class="form-group">
    <label for="body">Body</label>
    <textarea rows="4" class="form-control" name="body" id="body" placeholder="Reddit Markdown or URL">{{ post.body }}</textarea>
  </div>
  <div class="form-group">
    <label for="whendate">Date</label>
    <input type="date" name="whendate" class="form-control" id="whendate" value="{{ post.whendate }}">
  </div>
  <div class="form-group">
    <label for="whentime">Time</label>
    <input type="time" name="whentime" class="form-control" id="whentime" value="{{ post.whentime }}">
  </div>
  <button type="submit" name="submit" class="btn btn-primary">
    <i class="fa fa-check"></i>
    Save Changes
  </button>
  <button id="delete" type="submit" name="delete" class="btn btn-danger btn-sm">
    <i class="fa fa-trash"></i>
    Delete
  </button>
  {% else %}
  <div class="alert alert-info">
    <a class="btn btn-info float-right" href="{{ post.url }}" target="_blank">
      <i class="fa fa-link"></i>
      View Post
    </a>
    <div class="p-1">
      Post already submitted to Reddit and cannot be changed, but you can still
      add comments.
    </div>
  </div>
  {% endif %}

  <input id="whenzone" type="hidden" name="whenzone" value="UTC">
</form>


<div class="m-1">
  <a class="btn btn-primary" href="/comment?post={{ post.id }}">
    <i class="fa fa-comment"></i>
    Add Comment
  </a>
</div>

{% if post.__get('ownCommentList') %}
<table class="table table-bordered table-striped">
<thead>
  <tr>
    <th>Comment</th>
    <th>When</th>
  </tr>
</thead>
<tbody>
{% for comment in post.__get('ownCommentList') %}
<tr>
  <td>{{ comment.body }}</td>
  <td>{{ comment.delay }}</td>
</tr>
{% endfor %}
</tbody>
</table>
{% endif %}

<script>
$(function () {
  var zone = /(GMT[\+\-]\d+)/.exec(new Date().toString())[1];
  $('#whenzone').val(zone);

  $('#delete').click(function (e) {
    if (!confirm("Are you sure you want to delete?")) {
      e.preventDefault();
      e.stopPropigation();
    }
  });
});
</script>
